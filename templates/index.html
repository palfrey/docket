<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Docket</title>

		<link rel="stylesheet" href="/static/bower_components/bootstrap/dist/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<link rel="stylesheet" href="/static/bower_components/bootstrap/dist/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
		<script src="/static/bower_components/jquery/dist/jquery.min.js"></script>
		<script src="/static/bower_components/bootstrap/dist/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	</head>
	<body>
		<div class="container-fluid">
			{% with messages = get_flashed_messages() %}
			  {% if messages %}
			    {% for message in messages %}
			      <div class="alert alert-success" role="alert">{{ message }}</div>
			    {% endfor %}
			  {% endif %}
			{% endwith %}
			{% if not data %}
				<form action="https://todoist.com/oauth/authorize" method="post">
					<input type="hidden" name="client_id" value="{{ todoist['client_id'] }}" />
					<input type="hidden" name="scope" value="data:read_write" />
					<input type="hidden" name="state" value="secretstring" />
					<button type="submit" class="btn btn-default">Connect to Todoist</button>
				</form>
			{% else %}
				{% if data["beeminder_auth_token"] == None %}
					<a href="https://www.beeminder.com/apps/authorize?client_id={{ beeminder['client_id'] }}&redirect_uri={{ beeminder_url }}&response_type=token" class="btn btn-primary">Auth with Beeminder</a><br />
				{% else %}
					{{ data.beeminder_goals[0].keys()|sort }} <br />
					{{ data.beeminder_pretty_update() }}
					<form action="{{ url_for('beeminder_sync') }}" method="post">
						<button type="submit" class="btn btn-primary">Sync with Beeminder</button>
					</form>
				{% endif %}
				{{ data.todoist.keys()|sort }} <br />
				{{ data.todoist_pretty_update() }}
				<form action="{{ url_for('todoist_sync') }}" method="post">
					<button type="submit" class="btn btn-primary">Sync with Todoist</button>
				</form>
			{% endif %}
		</div>
	</body>
</html>
